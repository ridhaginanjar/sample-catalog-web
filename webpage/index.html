<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fashion Studio</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

    <style>
        body { font-family: 'Arial', sans-serif; margin: 0; color: #333; background-color: #f9f9f9; }
        header { background-color: #fff; border-bottom: 1px solid #eee; padding: 20px 0; }
        .navbar { display: flex; justify-content: space-between; alignItems: center; }
        .navbar-brand { font-size: 24px; color: #222; text-decoration: none; font-weight: bold; }
        .navbar-nav { list-style: none; padding: 0; margin: 0; display: flex; align-items: center; }
        .nav-item { margin-left: 20px; }
        .nav-link { text-decoration: none; color: #555; font-size: 16px; padding: 10px 0; display: block; }
        .nav-link:hover { color: #222; }
        .search-box { display: flex; align-items: center; border: 1px solid #ddd; border-radius: 5px; padding: 5px 10px; }
        .search-input { border: none; outline: none; font-size: 14px; margin-right: 5px; }
        .search-button { background: none; border: none; color: #777; cursor: pointer; }
        .container { padding: 20px; }
        .breadcrumbs { margin-bottom: 20px; font-size: 14px; color: #777; }
        .breadcrumbs a { color: #555; text-decoration: none; }
        .breadcrumbs span { margin: 0 5px; }
        .product-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .product-count { font-size: 16px; color: #555; }
        .sort-by { display: flex; align-items: center; }
        .sort-label { font-size: 16px; color: #555; margin-right: 10px; }
        .sort-select { padding: 8px; border-radius: 5px; border: 1px solid #ddd; appearance: none; -webkit-appearance: none; -moz-appearance: none; background-image: url('data:image/svg+xml;utf8,<svg fill="black" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'); background-repeat: no-repeat; background-position-x: 100%; background-position-y: 5px; }
        .collection-grid {
            display: flex; /* Ubah menjadi Flexbox */
            flex-wrap: wrap; /* Aktifkan wrapping */
            justify-content: center; /* Ratakan tengah item per baris */
            gap: 20px;
        }
        .collection-card { border-radius: 8px; overflow: hidden; background-color: #fff; display: flex; flex-direction: column; width: 280px; /* Tetapkan lebar card */ }
        .collection-image { width: 100%; height: 280px; object-fit: cover; display: block; }
        .product-details { padding: 15px; text-align: left; flex: 1; display: flex; flex-direction: column; justify-content: space-between; }
        .product-title { font-size: 16px; font-weight: bold; margin-bottom: 8px; color: #333; }
        .price-container { display: flex; align-items: center; margin-bottom: 5px; }
        .price { color: #e60000; font-weight: bold; margin-right: 10px; font-size: 16px; }
        .old-price { color: #777; text-decoration: line-through; font-size: 14px; }
        .sale-badge { background-color: #e60000; color: white; padding: 5px 10px; border-radius: 5px; font-size: 12px; font-weight: bold; position: absolute; top: 10px; left: 10px; }
        .pagination { display: flex; justify-content: center; margin-top: 30px; }
        .pager { list-style: none; padding: 0; margin: 0; display: flex; align-items: center; }
        .pager li { margin: 0 5px; }
        .pager a, .pager span { padding: 8px 12px; border: 1px solid #ddd; border-radius: 5px; text-decoration: none; color: #555; background-color: #fff; }
        .pager a:hover { background-color: #f8f8f8; }
        .pager .current, .pager .current:hover { background-color: #ddd; color: #222; border-color: #ccc; font-weight: bold; }
        .pager .disabled { opacity: 0.5; pointer-events: none; }
        footer { text-align: center; padding: 30px 0; border-top: 1px solid #eee; color: #777; font-size: 14px; }

    </style>
</head>
<body>
    <header>
        <div class="container">
            <nav class="navbar">
                <a class="navbar-brand" href="index.html">Perseus</a>
                <ul class="navbar-nav">
                    <li class="nav-item"><a href="#" class="nav-link">Shop</a></li>
                    <li class="nav-item"><a href="#" class="nav-link">Most wanted</a></li>
                    <li class="nav-item"><a href="#" class="nav-link">New arrival</a></li>
                    <li class="nav-item"><a href="#" class="nav-link">Brands</a></li>
                </ul>
                <div class="search-box">
                    <input type="text" class="search-input" placeholder="Search...">
                    <button class="search-button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16">
                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                        </svg>
                    </button>
                </div>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="breadcrumbs">
            <a href="index.html">Home</a> <span>/</span> Browse Products
        </div>

        <div class="product-header">
            <h2 class="product-count">Fashion Products</h2>
            <div class="sort-by">
                <span class="sort-label">Sort by:</span>
                <select class="sort-select">
                    <option>Popularity</option>
                    <option>Newest Items</option>
                    <option>Price: Low to High</option>
                    <option>Price: High to Low</option>
                </select>
            </div>
        </div>

        <div class="collection-grid" id="collectionList"></div>
    </div>

    <div class="container">
        <nav aria-label="Product pagination">
            <ul class="pager pagination">
                <li class="page-item previous disabled" id="prevPageContainer">
                    <a class="page-link" id="prevPage" href="#" tabindex="-1" aria-disabled="true">Previous</a>
                </li>
                <li class="page-item current"><span class="page-link"><span id="currentPage">1</span> of <span id="totalPages">1</span></span></li>
                <li class="page-item next" id="nextPageContainer">
                    <a class="page-link" id="nextPage" href="#">Next</a>
                </li>
            </ul>
        </nav>
    </div>

    <footer>
        <p>Â© 2025 Copyright. All right reserved</p>
    </footer>

    <script>
        // Check if the user is logged in
        if (!sessionStorage.getItem('loggedIn')) {
            window.location.href = 'login.html'; // Redirect to login page if not logged in
        }
        
        // Definisikan variabel categories, sizes, dan genders yang hilang
        const categories = ["Crewneck", "T-shirt", "Hoodie", "Pants", "Outerwear", "Jacket"];
        const sizes = ["S", "M", "L", "XL", "XXL"];
        const genders = ["Men", "Women", "Unisex"];

        const collectionsData = Array.from({ length: 100000 }, (_, i) => {
        // Data redundan: Menambahkan beberapa entri dengan informasi yang mirip
                if (i % 10 === 0) {
                    return {
                        id: i + 1,
                        title: `Unknown Product`,
                        price: "$100.00",
                        rating: "Invalid Rating",
                        size: "M",
                        gender: "Men",
                        image: `https://picsum.photos/280/350?random=${i + 1}`,
                        colors: 5 // Example color count
                    };
                }

                if (i % 15 === 0) {
                    return {
                        id: i + 1,
                        title: `${categories[i % categories.length]} ${i + 1}`,
                        price: null,
                        rating: null,
                        size: sizes[i % sizes.length],
                        gender: genders[i % genders.length],
                        image: `https://picsum.photos/280/350?random=${i + 1}`,
                        colors: 8 // Example color count
                    };
                }

                // Data kosong: Beberapa entri tidak memiliki harga atau rating
                return {
                    id: i + 1,
                    title: `${categories[i % categories.length]} ${i + 1}`,
                    price: i % 50 === 0 ? "" : `$${(Math.random() * 500 + 50).toFixed(2)}`, // Kosongkan harga pada setiap kelipatan 50
                    rating: i % 50 === 0 ? "" : (Math.random() * 2 + 3).toFixed(1), // Kosongkan rating pada setiap kelipatan 50
                    size: sizes[i % sizes.length],
                    gender: genders[i % genders.length],
                    image: `https://picsum.photos/280/350?random=${i + 1}`,
                    colors: 3 // Example color count
                };
        });

        const params = new URLSearchParams(window.location.search);
        let currentPage = parseInt(params.get('page')) || 1;
        const itemsPerPage = 12; // Jumlah item per halaman, bisa disesuaikan
        const totalPages = Math.ceil(collectionsData.length / itemsPerPage);
        document.getElementById('totalPages').textContent = totalPages;

        function renderCollections(page = 1) {
            const start = (page - 1) * itemsPerPage;
            const end = start + itemsPerPage;
            const collectionList = document.getElementById('collectionList');
            collectionList.innerHTML = '';

            const pageItems = collectionsData.slice(start, end);
            let rowIndex = 0;
            let itemsInRow = 0;

            pageItems.forEach(collection => {
                const card = document.createElement('div');
                card.className = 'collection-card';

                let saleBadgeHTML = '';
                if (collection.onSale) {
                    saleBadgeHTML = '<div class="sale-badge">SALE</div>';
                }

                // Handle cases where price or rating might be null or undefined
                const displayPrice = collection.price != null ? `<div class="price-container"><span class="price">${collection.price}</span>${collection.oldPrice ? `<span class="old-price">${collection.oldPrice}</span>` : ''}</div>` : '<p class="price">Price Unavailable</p>';
                const displayRating = collection.rating != null ? `<p style="font-size: 14px; color: #777;">Rating: â­ ${collection.rating} / 5</p>` : '<p style="font-size: 14px; color: #777;">Rating: Not Rated</p>';
                const displayColors = collection.colors != null ? `<p style="font-size: 14px; color: #777;">${collection.colors} Colors</p>` : '';
                const displaySize = collection.size != null ? `<p style="font-size: 14px; color: #777;">Size: ${collection.size}</p>` : '';
                const displayGender = collection.gender != null ? `<p style="font-size: 14px; color: #777;">Gender: ${collection.gender}</p>` : '';


                const cardHTML = `
                    <div style="position: relative;">
                        <img src="${collection.image}" class="collection-image" alt="${collection.title}">
                        ${saleBadgeHTML}
                    </div>
                    <div class="product-details">
                        <h3 class="product-title">${collection.title}</h3>
                        ${displayPrice}
                        ${displayRating}
                        ${displayColors}
                        ${displaySize}
                        ${displayGender}
                    </div>
                `;
                card.innerHTML = cardHTML;
                collectionList.appendChild(card);

                itemsInRow++;
                // Atur jumlah item per baris berdasarkan rowIndex untuk pola 3-4-3 (contoh kasar)
                let itemsPerRowTarget;
                if (rowIndex === 0 || rowIndex === 2) { // Baris 1 dan 3 (index 0 dan 2)
                    itemsPerRowTarget = 3;
                } else { // Baris 2 (index 1)
                    itemsPerRowTarget = 4;
                }

                if (itemsInRow >= itemsPerRowTarget && collectionList.children.length < pageItems.length) {
                    rowIndex++;
                    itemsInRow = 0;
                }

            });

            document.getElementById('currentPage').textContent = page;
            const prevPageContainer = document.getElementById('prevPageContainer');
            const nextPageContainer = document.getElementById('nextPageContainer');

            if (page === 1) {
                prevPageContainer.classList.add('disabled');
            } else {
                prevPageContainer.classList.remove('disabled');
            }

            if (page === totalPages) {
                nextPageContainer.classList.add('disabled');
            } else {
                nextPageContainer.classList.remove('disabled');
            }

            document.getElementById('prevPage').href = page > 1 ? `?page=${page - 1}` : '#';
            document.getElementById('nextPage').href = page < totalPages ? `?page=${page + 1}` : '#';
        }

        renderCollections(currentPage);
    </script>
</body>
</html>